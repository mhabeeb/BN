/*!
* Data Aquarium Framework - Offline Data Processor
* Copyright 2008-2017 Code On Time LLC; Licensed MIT; http://codeontime.com/license
*/
(function(){var n=$app,t;t=n.odp={offline:function(){return!1},invoke:function(t,i){function h(){$.ajax(i).done(function(n){u.resolve(n)}).fail(function(n,t,i){u.reject(n,t,i)})}var c=this,o=t.get_servicePath(),s=i.url.substring(o.length+1),r=i.data.match(/\"controller\":\"(.+?)\"/),u=$.Deferred(),f,e;return r&&(r=r[1]),n.touch&&s=="GetPage"&&(t.odp||(t._dataViewFieldParentId?(f=n.find(t._filterSource),f&&(t.odp=f.odp)):(e=t.get_parentDataView(),e&&(t._filterSource&&(t.odp=e.odp),t.odp||(t.odp=new n.OfflineDataProcessor(t)))),!t.odp&&t._isModal&&(t.odp=new n.OfflineDataProcessor(t)))),h(),u.promise()}};n.OfflineDataProcessor=function(n){this._dataView=n;this._state="inactive";this._data=[];this._log=[]};n.OfflineDataProcessor.prototype={is:function(n){if(arguments.length){if(n.match(/^:/))return this._state==n.substring(1);this._state=n}else return this._state},analyze:function(n){var t=this,i=n.dataView,r=i._lastArgs,f=!i._filterSource,u=n.method;t.is(":active")?u=="Execute"&&r&&r.CommandName.match(/^(Insert|Update|Delete)$/)&&t.is("commit"):f?u=="GetPage"&&i.get_lastCommandName()=="New"&&(t.root=i._id,t.is("active")):u=="Execute"&&r&&r.CommandName.match(/^(Insert|Update|Delete)$/)&&t.is("active")}}})();